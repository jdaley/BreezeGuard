<!DOCTYPE html>
<html>
<head>
    <title>TinyDemo</title>
    <link rel="stylesheet" type="text/css" href="demo.css" />
</head>
<body>
    <h1>TinyDemo API Client</h1>

    <div id="demos"></div>
    <div id="description">&nbsp;</div>

    <h2>Request</h2>

    <div>
        Method: <select id="method"><option>GET</option><option>POST</option></select>
        URL: <input id="url" type="text" />
        <button id="send">Send</button>
    </div>
    <div>
        Body:<br />
        <textarea id="requestbody"></textarea>
    </div>

    <h2>Response</h2>

    <div>Status: <input id="status" type="text" /></div>
    <div>
        Body:<br />
        <div id="responsebody"></div>
    </div>

    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="demo.js"></script>

    <script>
        window.demos = [
            {
                name: 'Metadata',
                description: 'Retrieve the Breeze metadata. The excluded User.Password property does not appear in metadata.',
                url: '/breeze/Entities/Metadata'
            },
            {
                name: 'All Users',
                description: 'Fetch all users. The excluded Password property is not returned, and we can only see users with ' +
                    'CustomerId = 1.',
                url: '/breeze/Entities/Users'
            },
            {
                name: 'Query by Password',
                description: 'Attempt to query Users using the excluded Password property. The server returns an error message ' +
                    'that the property does not exist.',
                url: '/breeze/Entities/Users?$filter=Password eq \'p@ssword\''
            },
            {
                name: 'OrderSummary DTO',
                description: 'Query the OrderSummary DTO. If you inspect the query that Entity Framework runs in the database, ' +
                    'you will see that the OData filter on the DTO property is translated to an SQL where clause.',
                url: '/breeze/Entities/OrderSummaries?$filter=TotalAmount gt 100'
            },
            {
                name: 'Create Order',
                description: 'Call SaveChanges to create a new order. See what happens if you try to change IsPaid or CustomerId.',
                method: 'POST',
                url: '/breeze/Entities/SaveChanges',
                body: 'createorder'
            },
            {
                name: 'Update Order.IsPaid',
                description: 'Attempt to directly modify Order.IsPaid. The server returns an error.',
                method: 'POST',
                url: '/breeze/Entities/SaveChanges',
                body: 'updateorderispaid'
            },
            {
                name: 'PaymentRequest DTO',
                description: 'Save a PaymentRequest, which causes Order.IsPaid to be set server-side.',
                method: 'POST',
                url: '/breeze/Entities/SaveChanges',
                body: 'paymentrequestdto'
            },
            {
                name: 'Update Line on Paid Order',
                description: 'Attempt to update an order line for an order that has been paid. The server returns a validation error.',
                method: 'POST',
                url: '/breeze/Entities/SaveChanges',
                body: 'updatelineonpaidorder'
            },
            {
                name: 'Update Another Customer\'s Order',
                description: 'Attempt to update an order that belongs to another customer. The server returns an error that the ' +
                    'record does not exist.',
                method: 'POST',
                url: '/breeze/Entities/SaveChanges',
                body: 'updateanothercustomersorder'
            }
        ];
    </script>

    <script type="text/template" id="createorder">
{
    "entities": [
        {
            "Id": -1,
            "IsPaid": false,
            "CustomerId": 1,
            "entityAspect": {
                "entityTypeName": "Order:#TinyDemo.Entities",
                "defaultResourceName": "Orders",
                "entityState": "Added",
                "originalValuesMap": {},
                "autoGeneratedKey": {
                    "propertyName": "Id",
                    "autoGeneratedKeyType": "Identity"
                }
            }
        },
        {
            "Id": -2,
            "OrderId": -1,
            "Description": "Coffee",
            "Price": 30,
            "entityAspect": {
                "entityTypeName": "OrderLine:#TinyDemo.Entities",
                "defaultResourceName": "OrderLines",
                "entityState": "Added",
                "originalValuesMap": {},
                "autoGeneratedKey": {
                    "propertyName": "Id",
                    "autoGeneratedKeyType": "Identity"
                }
            }
        }
    ],
    "saveOptions": {}
}
    </script>

    <script type="text/template" id="updateorderispaid">

    </script>

    <script type="text/template" id="paymentrequestdto">

    </script>

    <script type="text/template" id="updatelineonpaidorder">

    </script>

    <script type="text/template" id="updateanothercustomersorder">

    </script>

</body>
</html>
